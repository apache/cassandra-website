<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Apache Cassandra | Apache Cassandra Documentation</title>
    <link rel="stylesheet" href="../../assets/css/site.css">
    <meta name="description" content="The Apache Cassandra Community">
    <link rel="schema.dcterms" href="https://purl.org/dc/terms/">
    <meta name="dcterms.subject" content="_">
    <meta name="dcterms.identifier" content="master">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="icon" href="../../assets/img/favicon.ico" type="image/x-icon">
<script>
  const script = document.createElement("script");
  const domain = window.location.hostname;
  script.type = "text/javascript";
  script.src = "https://plausible.cassandra.apache.org/js/plausible.js";
  script.setAttribute("data-domain",domain);
  script.setAttribute("defer",'true');
  script.setAttribute("async",'true');
  document.getElementsByTagName("head")[0].appendChild(script);
</script>  </head>
  <body class="single-post">
      <div class="container mx-auto relative">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <meta property="og:type" content="website" />
	<meta property="og:description" content="" />
	<meta property="og:url" content="/" />
	<meta property="og:site_name" content="Apache Cassandra" />

<header id="top-nav">
    <div class="inner relative">
        <div class="header-social-icons text-right">
            <a href="https://twitter.com/cassandra?lang=en" target="_blank" styles="margin-left: 20px;"><img src="../../assets/img/twitter-icon-circle-white.svg" alt="twitter icon" width="24"></a>
            <a href="https://www.linkedin.com/company/apache-cassandra/"  target="_blank" styles="margin-left: 20px;"><img src="../../assets/img/LI-In-Bug.png" alt="linked-in icon" width="24"></a>
            <a href="https://www.youtube.com/c/PlanetCassandra" target="_blank" styles="margin-left: 20px;"><img src="../../assets/img/youtube-icon.png" alt="youtube icon" width="24"></a>
        </div>
        <div class="cf">
            <div class="logo left"><a href="/"><img src="../../assets/img/logo-white-r.png" alt="cassandra logo"></a></div>
            <div class="mobile-nav-icon right">
                <img class="toggle-icon" src="../../assets/img/hamburger-nav.svg">
            </div>
            <ul class="main-nav nav-links right flex flex-vert-center flex-space-between">
    <li>
        <a class="nav-link hide-mobile">Get Started</a>
        <ul class="sub-menu bg-white">
            <li class="pa-micro">
                <a href="/_/cassandra-basics.html">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-basics.png" alt="cassandra basics icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Cassandra Basics
                    </div>
                </a>
            </li>
            <li class="pa-micro">
                <a href="/_/quickstart.html">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-rocket.png" alt="cassandra basics icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Quickstart
                    </div>
                </a>
            </li>
            <li class="pa-micro">
                <a href="/_/ecosystem.html">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-ecosystem.png" alt="cassandra basics icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Ecosystem
                    </div>
                </a>
            </li>
        </ul>
    </li>
    <li><a class="nav-link" href="/doc/latest/">Documentation</a></li>
    <li>
        <a class="nav-link" href="/_/community.html">Community</a>
        <ul class="sub-menu bg-white">
            <li class="pa-micro">
                <a href="/_/community.html#code-of-conduct">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-welcome.png" alt="welcome icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Welcome
                    </div>
                </a>
            </li>
            <li class="pa-micro hide-mobile">
                <a href="/_/community.html#discussions">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-discussions.png" alt="discussions icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Discussions
                    </div>
                </a>
            </li>
            <li class="pa-micro hide-mobile">
                <a href="/_/community.html#project-governance">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-governance.png" alt="Governance icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Governance
                    </div>
                </a>
            </li>
            <li class="pa-micro hide-mobile">
                <a href="/_/community.html#how-to-contribute">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-contribute.png" alt="Contribute icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Contribute
                    </div>
                </a>
            </li>
            <li class="pa-micro hide-mobile">
                <a href="/_/community.html#meet-the-community">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-community.png" alt="Meet the Community icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Meet the Community
                    </div>
                </a>
            </li>
            <li class="pa-micro hide-mobile">
                <a href="/_/cassandra-catalyst-program.html">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-catalyst.png" alt="Catalyst icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Catalyst Program
                    </div>
                </a>
            </li>
            <li class="pa-micro hide-mobile">
                <a href="/_/events.html">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-events.png" alt="Events icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Events
                    </div>
                </a>
            </li>
        </ul>
    </li>
    <li>
        <a class="nav-link hide-mobile">Learn</a>
        <ul class="sub-menu bg-white">
            <li class="pa-micro">
                <a href="/_/Apache-Cassandra-5.0-Moving-Toward-an-AI-Driven-Future.html">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-basics.png" alt="Basics icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Cassandra 5.0
                    </div>
                </a>
            </li>
            <li class="pa-micro">
                <a href="/_/case-studies.html">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-case-study.png" alt="Case Studies icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Case Studies
                    </div>
                </a>
            </li>
            <li class="pa-micro">
                <a href="/_/resources.html">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-resources.png" alt="Resources icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Resources
                    </div>
                </a>
            </li>
            <li class="pa-micro">
                <a href="/_/blog.html">
                    <div class="sub-nav-icon">
                        <img src="../../assets/img/sub-menu-blog.png" alt="Blog icon">
                    </div>
                    <div class="sub-nav-text teal py-small">
                        Blog
                    </div>
                </a>
            </li>
        </ul>
    </li>
    <li><a class="nav-link btn btn--filled" href="/_/download.html">Download Now</a></li>
</ul>
        </div>
    </div>
</header>

        <div class="hero hero--home grad">
            <div class="eye"></div>
            <div id="home-content" class="text-center flex flex-center flex-column relative z2 ma-xlarge">
                <h1>Using Arithmetic Operators in Cassandra 4.0</h1>
                <h3>December 21, 2021 | Benjamin Lerer</h3>
            </div>
        </div>
        <div id="blog-post" class="flex-center py-large arrow">
            <div class="blog-breadcrumb mb-medium">
                <div class="inner inner--narrow">
                    <a href="/_/blog.html">« Back to the Apache Cassandra Blog</a>
                </div>
            </div>
            <div class="post-content">
                <div class="inner inner--narrow">
                    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="../_images/blog/using-arithmetic-operators-in-cassandra-4.0-unsplash-bekky-bekks.jpg" alt="operations"></span></p>
</div>
<div class="paragraph">
<p>Support for arithmetic operators was added to CQL in Cassandra 4.0 and this blog post describes the important things to know about CQL arithmetics operators, and how we addressed the non-trivial challenges around return types and types inference.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="operations-on-numbers"><a class="anchor" href="#operations-on-numbers"></a>Operations on Numbers</h3>
<div class="paragraph">
<p>Cassandra supports five arithmetic operators on numbers:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Arithmetic Operators in 4.0</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">negates operand/subtraction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">multiplication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">division</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns the remainder of a division</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Those operators can be used in the <code>SELECT</code> <code>INSERT</code>, <code>UPDATE,</code> and <code>DELETE</code> statements to perform some computations. For example, if you wish to know the percentage of completion of the currently running compactions, you can query the <code>sstable_tasks</code> system view using the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">SELECT keyspace_name,
table_name,
Task_id,
(progress * 100) / total AS percentage_of_completion
FROM system_views.sstable_tasks
WHERE kind = 'compaction'
ALLOW FILTERING;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-important-role-of-return-types"><a class="anchor" href="#the-important-role-of-return-types"></a>The Important Role of Return Types</h3>
<div class="paragraph">
<p>An important thing to take into account when using operators is the return type of the operation. In Cassandra the return type is based on the type of the operands and can be determined using the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Return Type Based on Operand in Apache Cassandra</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Left/Right</th>
<th class="tableblock halign-left valign-top">tinyint</th>
<th class="tableblock halign-left valign-top">smallint</th>
<th class="tableblock halign-left valign-top">int</th>
<th class="tableblock halign-left valign-top">bigint</th>
<th class="tableblock halign-left valign-top">counter</th>
<th class="tableblock halign-left valign-top">float</th>
<th class="tableblock halign-left valign-top">double</th>
<th class="tableblock halign-left valign-top">varint</th>
<th class="tableblock halign-left valign-top">decimal</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tinyint</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tinyint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">smallint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>smallint</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">smallint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">smallint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>int</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>bigint</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>counter</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>float</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>varint</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>decimal</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Based on that table you can see that if the <code>percentage_of_completion</code> had been computed as <code>(progress / total) * 100</code> instead of as <code>(progress * 100) / total</code> the output will always have been a <code>bigint</code> equal to <code>0</code> or <code>1</code>. As <code>progress</code> and <code>total</code> are both <code>bigints</code> the output of the division would have been of type <code>bigint</code> and equal to 0 if <code>progress</code> was smaller than <code>total</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="type-inference"><a class="anchor" href="#type-inference"></a>Type Inference</h3>
<div class="paragraph">
<p>Of course, literals also play a role in the selection of the return type. Cassandra will try to infer the type of the literals to determine how the operation must be performed.
In an expression like <code>percentage_of_completion</code>, the only information that C* has to infer the type is its value.
If the literal is an integer, C* will look at it and consider it as an <code>int</code>, a <code>bigint</code> or a <code>varint</code> if the type can hold this value. For example, in our computation, 100 will be considered as an <code>int</code> because the value can fit in a 32-bit signed integer.
For floats, C* will consider them as either <code>doubles</code> or <code>decimals</code>.
If the <code>percentage_of_completion</code> had been computed as <code>(progress * 100.0) / total</code>, 100.0 would have been considered as a <code>double</code> and the <code>percentage_of_completion</code> type would also have been a <code>double</code>.
Now, in some cases, Cassandra knows the return type of the expression and can use it to infer the type of the literals.
If for example we have a table like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">CREATE TABLE myTable (pk int, c tinyint, v text, PRIMARY KEY(pk, c));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cassandra will be able to prepare the following query without problem.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">SELECT * FROM myTable WHERE pk = 2 AND c = 1 + ?;</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the <code>c</code> column is of type <code>tinyint</code>, C* can guess that the binding parameter and the literal would be of the <code>tinyint</code> type as only the sum of 2 <code>tinyints</code> can return a <code>tinyint</code>.
But if you try to prepare the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">SELECT * FROM myTable WHERE pk = ? + 1 AND c = 1;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cassandra will return an error saying:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Ambiguous '+' operation with args ? and 1: use type casts to disambiguate</code></pre>
</div>
</div>
<div class="paragraph">
<p>The problem here is that the binding parameter could have 3 different types (<code>tinyint</code>, <code>smallint</code> or <code>int</code>) and C* does not know which one the user intend to use.</p>
</div>
</div>
<div class="sect2">
<h3 id="hints-and-casting-to-the-rescue"><a class="anchor" href="#hints-and-casting-to-the-rescue"></a>Hints and Casting to the Rescue</h3>
<div class="paragraph">
<p>To solve type inference problems related to binding parameters Cassandra has support for <strong>type hints</strong>. A type hint is a way to explicitly tell Cassandra what will be the type of the parameter.
For example in our previous example if the binding parameter will be an <code>int</code>, the query can be modified as follow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">SELECT * FROM myTable WHERE pk = (int) ? + 1 AND c = 1;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Type hints can also be used to control the type of a literal. If we go back to the <strong>sstable_tasks</strong> query. We could have changed the type of the <code>percentage_of_completion</code> to <code>decimal</code> by using a <code>decimal</code> type hint in front of the literal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">(progress * (decimal) 100) / total AS percentage_of_completion</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course, the same result could have been reached by casting progress into a decimal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">(CAST(progress AS decimal) * 100) / total AS percentage_of_completion</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">(CAST(progress AS decimal) / total) * 100 AS percentage_of_completion</code></pre>
</div>
</div>
<div class="paragraph">
<p>as the operation between a <code>decimal</code> and a <code>bigint</code> will result in a decimal.</p>
</div>
</div>
<div class="sect2">
<h3 id="operator-precedence"><a class="anchor" href="#operator-precedence"></a>Operator Precedence</h3>
<div class="paragraph">
<p><code>*</code>, <code>/</code> and <code>%</code> operators have a higher precedence level than <code>+</code> and <code>-</code> operator. By consequence, they will be evaluated before the other two. If two operators in an expression have the same precedence level, they will be evaluated left to right based on their positions in the expression.
Parentheses can be used to modify the order in which the operations must be performed within an expression. Everything within parentheses will be evaluated first to yield a single value before that value can be used by any operator outside the parentheses.
For example, it is possible to compute the percentage remaining before completion for the compactions as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">(total - progress) * 100 / total AS remaining_percentage</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="operations-on-timestamps-and-dates"><a class="anchor" href="#operations-on-timestamps-and-dates"></a>Operations on Timestamps and Dates</h3>
<div class="paragraph">
<p>In version 4.0, CQL also supports the addition or subtraction of durations from <code>timestamps</code> and <code>dates</code>.
If you are working with time-series data and use the following table to store your sensor data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">CREATE TABLE sensor_data (
sensor text,
day date,
ts timeuuid,
value double,
primary key((sensor, day), ts)
) WITH CLUSTERING ORDER BY (ts DESC)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the following query to retrieve some statistics on the data from the previous day:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">SELECT sensor, day, min(value), max(value), avg(value)
FROM sensor_data
WHERE sensor = ? AND day = currentdate() - 1d;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can express durations as <code>(quantity unit)+</code> like <code>12h30m</code> where the unit can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>y</code>: years (12` months)</p>
</li>
<li>
<p><code>mo</code>: months (1 month)</p>
</li>
<li>
<p><code>w</code>: weeks (7 days)</p>
</li>
<li>
<p><code>d</code>: days (1 day)</p>
</li>
<li>
<p><code>h</code>: hours (3,600,000,000,000 nanoseconds)</p>
</li>
<li>
<p><code>m</code>: minutes (60,000,000,000 nanoseconds)</p>
</li>
<li>
<p><code>s</code>: seconds (1,000,000,000 nanoseconds)</p>
</li>
<li>
<p><code>ms</code>: milliseconds (1,000,000 nanoseconds)</p>
</li>
<li>
<p><code>us</code> or <code>µs</code> : microseconds (1000 nanoseconds)</p>
</li>
<li>
<p><code>ns</code>: nanoseconds (1 nanosecond)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="what-about-daylight-savings-and-leap-seconds"><a class="anchor" href="#what-about-daylight-savings-and-leap-seconds"></a>What About Daylight Savings and Leap Seconds?</h3>
<div class="paragraph">
<p>Internally the timestamp and date types store information in UTC time. As UTC does not change with a change of seasons arithmetic operations on timestamps and dates are safe and will always return the expected results. However, be aware that the Java libraries used internally by Cassandra, ignore leap seconds.</p>
</div>
</div>
                </div>
            </div>
        </div>
        <footer class="grad grad--two flex-center pb-xlarge">
    <div class="inner text-center z2 relative">
        <h2 class="white py-small">Get started with Cassandra, fast.</h2>
        <a id="footer-cta" href="/_/quickstart.html" class="btn btn--filled ma-medium">Quickstart Guide</a>
    </div>
    <div class="inner flex flex-distribute-items mt-xlarge z2 relative">
        <div class="col-2">
            <div id="footer-logo" class="logo logo--footer mb-medium"><img src="../../assets/img/logo-white-r.png" alt="Cassandra Logo"></div>
            <p>Apache Cassandra<img src="../../assets/img/registered.svg" alt="®" style="width:18px;"> powers mission-critical deployments with improved performance and unparalleled levels of scale in the cloud.</p>
            <div class="footer-social-icons">
                <a href="https://twitter.com/cassandra?lang=en" target="_blank"><img src="../../assets/img/twitter-icon-circle-white.svg" alt="twitter icon" width="24"></a>
                <a href="https://www.linkedin.com/company/apache-cassandra/" target="_blank"><img src="../../assets/img/LI-In-Bug.png" alt="linked-in icon" width="24"></a>
                 <a href="https://www.youtube.com/c/PlanetCassandra" target="_blank"><img src="../../assets/img/youtube-icon.png" alt="youtube icon" width="24"></a>
            </div>
        </div>
        <div class="col-2 flex flex-center">
            <ul class="columns-2">
                <li class="mb-small"><a href="/">Home</a></li>
                <li class="mb-small"><a href="/_/cassandra-basics.html">Cassandra Basics</a></li>
                <li class="mb-small"><a href="/_/quickstart.html">Quickstart</a></li>
                <li class="mb-small"><a href="/_/ecosystem.html">Ecosystem</a></li>
                <li class="mb-small"><a href="/doc/latest/">Documentation</a></li>
                <li class="mb-small"><a href="/_/community.html">Community</a></li>
                <li class="mb-small"><a href="/_/case-studies.html">Case Studies</a></li>
                <li class="mb-small"><a href="/_/resources.html">Resources</a></li>
                <li class="mb-small"><a href="/_/blog.html">Blog</a></li>
            </ul>
        </div>
    </div>
</footer>
<div class="lower-footer bg-white pa-medium">
    <div class="flex flex-row flex-vert-center">
        <div class="pr-medium"><img src="../../assets/img//feather-small.png" alt="ASF" width="20"></div>
        <div class="pr-medium"><a href="http://www.apache.org/" target="_blank">Foundation</a></div>
        <div class="pr-medium"><a href="https://www.apache.org/events/current-event.html" target="_blank">Events</a></div>
        <div class="pr-medium"><a href="https://www.apache.org/licenses/" target="_blank">License</a></div>
        <div class="pr-medium"><a href="https://www.apache.org/foundation/thanks" target="_blank">Thanks</a></div>
        <div class="pr-medium"><a href="https://www.apache.org/security" target="_blank">Security</a></div>
        <div class="pr-medium"><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank">Privacy</a></div>
        <div class="pr-medium"><a href="https://www.apache.org/foundation/sponsorship" target="_blank">Sponsorship</a></div>
    </div>
    <p class="my-medium">© 2009-<script>document.write(new Date().getFullYear())</script> <a href="https://apache.org" target="_blank">The Apache Software Foundation</a> under the terms of the Apache License 2.0.  Apache, the Apache feather logo, Apache Cassandra, Cassandra, and the Cassandra logo, are either registered trademarks or trademarks of The Apache Software Foundation.</p>
</div>
<div id="fade" class="hidden"></div>
<div id="modal" class="hidden">
  <div id="close-modal" class="cursor-pointer"><svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div>
  <div id="mod-content" class="vid-mod-content resp-container"></div>
</div>
<script>
jQuery(function(){
    var windowW = $(window).width();
    $(document)
    .on('click','.mobile-nav-icon',function(){
        $('.main-nav').fadeIn();
    })
    .on('click','.main-nav',function(){
        if(windowW <= 1000){
            $(this).fadeOut();
        }
    })
    .on('click','#version-toggle',function(){
      $(this).toggleClass('active');
      $(this).next().fadeToggle();
    })
    .on('click','#mobile-docs-nav-burger', function(){
      $(this).toggleClass('active');
      $('.docs-nav').toggleClass('active');
    });
    var url = window.location.pathname;
    var isQuickstart = url.includes('quickstart.html');
    if(isQuickstart){
      var footerCTA = document.getElementById('footer-cta');
      footerCTA.innerHTML = 'Get latest updates';
      footerCTA.setAttribute('href', '/_/blog.html');
    }
});
</script>
      </div>
  </body>
<script>
jQuery(function(){
    
});
</script>
</html>
